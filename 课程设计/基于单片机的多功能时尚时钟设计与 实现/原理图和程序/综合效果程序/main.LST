C51 COMPILER V9.53.0.0   MAIN                                                              11/24/2020 12:40:26 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\main.obj
COMPILER INVOKED BY: E:\Keil\C51\BIN\C51.EXE main.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2) OBJECT(..\
                    -main.obj)

line level    source

   1          
   2          #include "task.h"
   3          
   4          bit BIT_10MS;
   5          
   6          extern void OS_ALLRun(void);
   7          extern void start(void);
   8          
   9          /*********************************************************************************************************
  10          ** ∫Ø ˝√˚≥∆: init
  11          ** π¶ƒ‹√Ë ˆ: ≥ı ºªØ≥Ã–Ú,¥À¥¶∞¸∫¨∂® ±∆˜0°¢¥Æ––ø⁄≥ı ºªØ
  12          **  ‰°°°°»Î: Œﬁ
  13          **  ‰°°°°≥ˆ: Œﬁ
  14          ** »´æ÷±‰¡ø: Œﬁ
  15          ** µ˜”√ƒ£øÈ: 
  16            **
  17          ** ◊˜°°°°’ﬂ: 
  18          ** »’°°°°∆⁄: 
  19          **-------------------------------------------------------------------------------------------------------
  20          ** –ﬁ ∏ƒ »À:
  21          ** »’°°°°∆⁄:
  22          **------------------------------------------------------------------------------------------------------
  23          ********************************************************************************************************/
  24          void init()
  25          {
  26   1          
  27   1        //"œµÕ≥≥ı ºªØ"
  28   1        //IE = 0x00;      //"«Â≥˝÷–∂œ"
  29   1        EA = 1;     //◊‹÷–∂œ
  30   1        //ES = 1;         //4"¥Æ––÷–∂œ‘ –Ì"
  31   1        //EX0 = 1;        //0"Õ‚≤ø÷–∂œ0‘ –Ì"
  32   1        //ET0 = 1;        //1"∂® ±∆˜0÷–∂œ‘ –Ì"
  33   1        //EX1 = 1;        //2"Õ‚≤ø÷–∂œ1‘ –Ì"
  34   1        //ET1 = 1;        //3"∂® ±∆˜1÷–∂œ‘ –Ì"
  35   1        //ET2 = 1;
  36   1        //IP = 0;         //"«Â≥˝÷–∂œ”≈œ»º∂"
  37   1        //PS = 1;         //"¥Æ––÷–∂œ”≈œ»"
  38   1        //PX0 = 1;        //"Õ‚≤ø÷–∂œ0"
  39   1        //PT0 = 1;        //"∂® ±∆˜÷–∂œ0"
  40   1        //PX1 = 1;        //"Õ‚≤ø÷–∂œ1"
  41   1        //PT1 = 0;        //"∂® ±∆˜÷–∂œ1"
  42   1        //TCON--------     "∂® ±∆˜øÿ÷∆ºƒ¥Ê∆˜",   TF1 | TR1 | TF0 | TR0 | IE1 | IT1 | IE0 | IT0
  43   1        //TCON = 0;
  44   1        //TF1             "T1“Á≥ˆ±Í÷æ"
  45   1        //TR1 = 1;        //"T1‘À––øÿ÷∆"
  46   1        //TF0             "T0“Á≥ˆ±Í÷æ"
  47   1        //TR0 = 1;        //"T0‘À––øÿ÷∆"
  48   1        //IE1             "Õ‚≤ø÷–∂œ1…Í«Î±Í÷æ"
  49   1        //IT1 = 1;        //"Õ‚≤ø÷–∂œ1¥•∑¢∑Ω Ω 0=µÁ∆Ω 1=±ﬂ—ÿ"
  50   1        //IE0             "Õ‚≤ø÷–∂œ0…Í«Î±Í÷æ"
  51   1        //IT0 = 1;        //"Õ‚≤ø÷–∂œ0¥•∑¢∑Ω Ω 0=µÁ∆Ω 1=±ﬂ—ÿ"
  52   1        //TMOD--------    "∂® ±∆˜ƒ£ Ωøÿ÷∆ºƒ¥Ê∆˜"
  53   1        //  | GATE   | C//T   | M0     | M1    | GATE   | C//T   | M0       | M1        |
  54   1        //"∏ﬂ4Œª”√”⁄T1  µÕ4Œª”√”⁄T0"
C51 COMPILER V9.53.0.0   MAIN                                                              11/24/2020 12:40:26 PAGE 2   

  55   1        //TMOD = 0x21;
  56   1        //SCON  "¥Æ––øÿ÷∆"
  57   1        //| SM0 | SM1 | SM2 | REN | TB8 | RB8 | TI  | RI  |
  58   1        //"| SM0  SM1 | π§◊˜∑Ω Ω  |   Àµ    √˜   |   ≤® Ãÿ ¬     |"
  59   1        //"|   0    0 | ∑Ω  Ω 0   |¥  Õ¨≤Ω“∆Œª   |   fosc/12     |"
  60   1        //"|   0    1 | ∑Ω  Ω 1   | 10Œª“Ï≤Ω ’∑¢ |  ∂® ±∆˜øÿ÷∆   |"
  61   1        //"|   1    0 | ∑Ω  Ω 2   | 11Œª“Ï≤Ω ’∑¢ |fosc/32|fosc/64|"
  62   1        //"|   1    1 | ∑Ω  Ω 3   | 11Œª“Ï≤Ω ’∑¢ |  ∂® ±∆˜øÿ÷∆   |"
  63   1        //"SM2 ∂‡ª˙Õ®—∂‘ –Ì"
  64   1        //"REN Ω” ’‘ –Ìøÿ÷∆"
  65   1        //"TB8 ∑¢ÀÕ ˝æ›µ⁄9Œª"
  66   1        //"RB8 Ω” ’ ˝æ›µ⁄9Œª"
  67   1        //"TI  ∑¢ÀÕ÷–∂œ±Í÷æ"
  68   1        //"RI  Ω” ‹÷–∂œ±Í÷æ"
  69   1        //SCON = 0x50;
  70   1        //PCON "µÁ‘¥øÿ÷∆ºƒ¥Ê∆˜"
  71   1        //SMOD"≤®Ãÿ¬ —°‘ÒŒª =1 ∑Ω Ω1,2,3 ≤®Ãÿ¬ º”±∂"
  72   1        //"≤®Ãÿ¬ =2^(sod)*fosc/(32*12*(256-≥ı÷µ))"
  73   1          //T2CON = 0x0;
  74   1          //TR2 = 1;
  75   1          //ET2 = 1;
  76   1      //-----------÷–î‡≥ı ºªØ-------------------------------------------------  BELL
  77   1      //INT0 init     
  78   1      #ifdef EN_OS_INT0
  79   1          IT0 = 1;    //Õ‚≤ø÷–∂œŒ™±ﬂ—ÿ¥•∑¢
  80   1          EX0 = 1;    //‘ –ÌÕ‚≤ø÷–∂œ
  81   1        
  82   1      #endif
  83   1      
  84   1       
  85   1      
  86   1        #ifdef EN_OS_INT1
  87   1      //  PX1 = 1;    //"Õ‚≤ø÷–∂œ1"
  88   1          IT1 = 1;    //Õ‚≤ø÷–∂œŒ™±ﬂ—ÿ¥•∑¢
  89   1          EX1 = 1;    //‘ –ÌÕ‚≤ø÷–∂œ 
  90   1        #endif    
  91   1        
  92   1          
  93   1      #ifdef EN_OS_SERIAL
  94   1          SCON = 0x50;
  95   1          //TMOD|= 0x20;
  96   1        BRT    = 0xfb;  //0xfb: 18.432MHz,12T,SMOD=0,9600bps
  97   1        AUXR   |= 0x11; //  π”√∂¿¡¢≤®Ãÿ¬ ∑¢…˙∆˜
  98   1         /* TH1  = 0xFB;
  99   1          TL1  = 0xFB;
 100   1          TR1  = 1; */
 101   1        //  ES   = 1;       //‘ ‘S¥Æø⁄÷–î‡
 102   1         // PS = 1;         //"¥Æ––÷–∂œ”≈œ»"
 103   1         // PSH;
 104   1      #endif
 105   1      
 106   1      #ifdef EN_OS_TIMER0
 107   1      /****************∂® ±∆˜0≥ı ºªØ****************/
 108   1        TMOD|=0X01;
 109   1          ET0=1; 
 110   1        TH0 = 0x0FD; //400us
 111   1          TL0 = 0x9A;
 112   1        IPH=0X09;    
 113   1      #endif
 114   1      /****************∂® ±∆˜1≥ı ºªØ****************/
 115   1      #ifdef EN_OS_TIMER1
 116   1           TMOD|=0X20;//8Œª◊‘∂Ø÷ÿ‘ÿƒ£ Ω 
C51 COMPILER V9.53.0.0   MAIN                                                              11/24/2020 12:40:26 PAGE 3   

 117   1           ET1=1;  //∂® ±∆˜0ø™÷–∂œ
 118   1           TH1=0x00;//∂® ±160us æß’Ò18.432M
 119   1           TL1=0x00;
 120   1      #endif
 121   1      /***************************/
 122   1      #ifdef EN_OS_UART2   
              
                S2CON  = 0x50;  //0101,0000 8Œªø…±‰≤®Ãÿ¬ £¨Œﬁ∆Ê≈º–£—ÈŒª,‘ –ÌΩ” ’
                BRT    = 0xfb;  //0xfb: 18.432MHz,12T,SMOD=0,9600bps
                AUXR   |= 0x11;  //T0x12,T1x12,UART_M0x6,BRTR,S2SMOD,BRTx12,EXTRAM,S1BRS  
                IE2     = 0x01; //‘ –Ì¥Æø⁄2÷–∂œ,ES2=1
              #endif
 129   1      
 130   1      /***/
 131   1      #ifdef EN_OS_PCA0  //”√”⁄16Œª∂® ±
 132   1      
 133   1          CMOD = 0x80;     //12∑÷∆µ
 134   1          CCON = 0x00;   //«Â÷–∂œ±Í÷æ
 135   1          CL = 0;
 136   1          CH = 0;
 137   1        CCAP0H = 0xEF; //40ms∂® ±
 138   1          CCAP0L = 0xD8;  
 139   1        CCAPM0 = 0x49; //…Ë÷√PCA0Œ™16Œª∂® ±∆˜£¨‘ –ÌPCAƒ£øÈ0÷–∂œ
 140   1        //CR=1; //∆Ù∂ØPCAº∆ ˝
 141   1      #endif
 142   1      /*******************************************/
 143   1      #ifdef EN_OS_PCA1   //”√”⁄16Œª∂® ±
              
                  CMOD = 0x80;     //12∑÷∆µ
                CCON = 0x00;   //«Â÷–∂œ±Í÷æ    
                  CL = 0;
                  CH = 0;  
                  CCAP1H =0x01;
                  CCAP1L =0x68; //us∂® ±
                //CCAPM1 = 0x49;  ‘ –ÌPCAƒ£øÈ1÷–∂œ 
              
              #endif
 154   1      /***********************************************************************/
 155   1      }
 156          /*********************************************************************************************************
 157          ** ∫Ø ˝√˚≥∆: main
 158          ** π¶ƒ‹√Ë ˆ: ÷˜∫Ø ˝£¨”√ªß≥Ã–Ú¥”’‚¿Ô÷¥––
 159          **  ‰°°°°»Î: Œﬁ
 160          **  ‰°°°°≥ˆ: Œﬁ
 161          ** »´æ÷±‰¡ø: Œﬁ
 162          ** µ˜”√ƒ£øÈ: init()
 163          **
 164          ** ◊˜°°°°’ﬂ:
 165          ** »’°°°°∆⁄: 
 166          **-------------------------------------------------------------------------------------------------------
 167          ** –ﬁ ∏ƒ »À:
 168          ** »’°°°°∆⁄:
 169          **------------------------------------------------------------------------------------------------------
 170          ********************************************************************************************************/
 171          
 172          void main(void)
 173          {
 174   1          init();
 175   1        start();
 176   1                  
 177   1        while(1)
 178   1        {
C51 COMPILER V9.53.0.0   MAIN                                                              11/24/2020 12:40:26 PAGE 4   

 179   2             OS_ALLRun();
 180   2          }
 181   1       }
 182           /*********************************************************************************/
 183          /*************************************************************************************
 184          ************************************************************************************
 185          ***********************                                     ***************************
 186          ***********************    http://59tiaoba.taobao.com       ***************************
 187          ***********************                                     ***************************
 188          ********************************≥Ã–Ú±‡–¥£∫Fucp****************************************
 189          **********************************************************************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     73    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
